{% assign filters = site.data.browsebuttons %}
{% assign page-nav = site.data.pagesnav %}
<div id="sidebar" class="border-right d-none d-md-block pl-5">
    {% if page.url contains 'collections' %}
    <h3>Search:</h3>
    <hr>
    <nav id="sidenav" class="pt-3 side-search">
        <ul class="list-unstyled components" id="accordion">
            <li class="border-bottom border-top py-2 pl-1 pr-4">
                <a href="#locations" id="locationsOne" class="dropdown-toggle" data-toggle="collapse" aria-expanded="false" aria-controls="locations">Locations</a>
                <ul class="collapse list-unstyled overflow" id="locations" aria-labelledby="locationsOne" data-parent="#accordion">
                    {% for f in filters %}
                    {% if f.category == 'Locations' %}
                    <li class="pl-3 mt-1 {% if page.url contains f.title %} active {% endif %}">
                        <a href="{{ f.title | strip | url_param_escape | prepend: '/collections.html#' | relative_url }}">{{ f.title }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </li>
            <li class="border-bottom py-2 pl-1 pr-4">
                <a href="#subjects" id="subjectsOne" class="dropdown-toggle" data-toggle="collapse" aria-expanded="false" aria-controls="subjects">Subjects</a>
                <ul class="collapse list-unstyled overflow" id="subjects" aria-labelledby="subjectsOne" data-parent="#accordion">
                    {% for f in filters %}
                    {% if f.category == 'Subjects' %}
                    <li class="pl-3 mt-1 {% if page.url contains f.title %} active {% endif %}">
                        <a href="{{ f.title | strip | url_param_escape | prepend: '/collections.html#' | relative_url }}">{{ f.title }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </li>
            <li class="border-bottom py-2 pl-1 pr-4">
                <a href="#media-types" id="mediaOne" class="dropdown-toggle" data-toggle="collapse" aria-expanded="false" aria-controls="media-types">Media Types</a>
                <ul class="collapse list-unstyled overflow" id="media-types" aria-labelledby="mediaOne" data-parent="#accordion">
                    {% for f in filters %}
                    {% if f.category == 'Media Types' %}
                    <li class="pl-3 mt-1 {% if page.url contains f.title %} active {% endif %}">
                        <a href="{{ f.title | strip | url_param_escape | prepend: '/collections.html#' | relative_url }}">{{ f.title }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </li>
            <li class="border-bottom py-2 pl-1 pr-4">
                <a href="#idaho" id="idahoOne" class="dropdown-toggle" data-toggle="collapse" aria-expanded="false" aria-controls="idaho">Idaho</a>
                <ul class="collapse list-unstyled overflow" id="idaho" aria-labelledby="idahoOne" data-parent="#accordion">
                    {% for f in filters %}
                    {% if f.category == 'Idaho' %}
                    <li class="pl-3 mt-1 {% if page.url contains f.title %} active {% endif %}">
                        <a href="{{ f.title | strip | url_param_escape | prepend: '/collections.html#' | relative_url }}">{{ f.title }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </li>
            <li class="border-bottom py-2 pl-1 pr-4">
                <a href="#university" id="universityOne" class="dropdown-toggle" data-toggle="collapse" aria-expanded="false" aria-controls="university">University of Idaho</a>
                <ul class="collapse list-unstyled overflow" id="university" aria-labelledby="universityOne" data-parent="#accordion">
                    {% for f in filters %}
                    {% if f.category == 'University of Idaho' %}
                    <li class="pl-3 mt-1 {% if page.url contains f.title %} active {% endif %}">
                        <a href="{{ f.title | strip | url_param_escape | prepend: '/collections.html#' | relative_url }}">{{ f.title }}</a>
                    </li>
                    {% endif %}
                    {% endfor %}
                </ul>
            </li>
        </ul>
    </nav>
    {% else %}
    <h3>{{ page.section }}</h3>
    <hr>
    <nav id="sidenav">
        <ul class="list-unstyled components">
            {% for sub in page-nav[page.section] %}
            {% if sub.subpages %}{% assign urls = sub.subpages | map: "url" %}
            <li class="border-bottom py-2 pl-1 pr-4">
                <a {%if sub.type != "direct-link" %}href="#{{ sub.subsection | slugify }}" data-toggle="collapse" aria-expanded="false" {%else %}href="{{ sub.link | relative_url }}"{%endif%}class="dropdown-toggle" >{{ sub.subsection }}</a>
                <ul class="collapse {% if urls contains page.url %} show{% endif %} list-unstyled" id="{{ sub.subsection | slugify }}">
                    {% for p in sub.subpages %}
                    <li class="pl-3 mt-1 {% if p.url == page.url %} active{% endif %}">
                        <a href="{{ p.url | relative_url }}">{{ p.name }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </li>
            {% else %}
            <li class="border-bottom py-2 pl-1 pr-4 {% if sub.link == page.url %} active{% endif %}">
                <a href="{{ sub.link | relative_url }}">{{ sub.subsection }}</a>
            </li>
            {% endif %}
            {% endfor %}
        </ul>
    </nav>
{% endif %}
</div>

